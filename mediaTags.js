var mediaTags={};var type;var mediaTitle;var albumTitle;var ifBooks=true;var ifGames=true;var booksKey;var gamesKey;var Apis;(function(a){Apis=function(k,c){if(k===""||null){ifBooks=false}else{booksKey=k;ifBooks=true}if(c===""||null){ifGames=false}else{gamesKey=c;ifGames=true}var i=a(".meta");var e=i.find("ul.tags li a").length;var f=-1;var b=false;var h=0;if(e<=0){return true}var l=false;var d=false;var g=false;var j=false;i.find("ul.tags li a").each(function(){var m=a(this).html();if(m.indexOf("film:")>=0){if(j){return true}b=true;type="film";mediaTitle=m.replace("film: ","");a(this).parent("li").remove();h++;j=true}if(m.indexOf("show:")>=0){if(j){return true}b=true;type="show";mediaTitle=m.replace("show: ","");a(this).parent("li").remove();h++;j=true}if(m.indexOf("artist:")>=0){if(l){return false}b=true;type="artist";mediaTitle=m.replace("artist: ","");a(this).parent("li").remove();h++;l=true}if(m.indexOf("album:")>=0){if(d){return false}b=true;type="album";albumTitle=m.replace("album: ","");a(this).parent("li").remove();h++;d=true}if(ifBooks){if(m.indexOf("book:")>=0){if(j){return true}b=true;type="book";mediaTitle=m.replace("book: ","");a(this).parent("li").remove();h++;j=true}}if(ifGames){if(m.indexOf("game:")>=0){if(j){return true}b=true;type="game";mediaTitle=m.replace("game: ","");a(this).parent("li").remove();h++;j=true}}if(m.indexOf("rating:")>=0){var o=m.replace("rating: ","");var n=isNumber(o);if(n){f=parseFloat(o)}a(this).parent("li").remove();h++}if(m.indexOf("noartwork")>=0){g=true;a(this).parent("li").remove();h++}});if(h===e){i.find("ul.tags").remove()}if(d&&!l){b=false}if(d&&l){type="album"}if(b){if(d){mediaTags={title:mediaTitle,albumTitle:albumTitle,rating:f,type:type,noartwork:g};logMedia()}else{mediaTags={title:mediaTitle,rating:f,type:type};logMedia()}}else{if(f>=0){rateMedia(f,false)}}}})(jQuery);function isNumber(a){return !isNaN(parseFloat(a))&&isFinite(a)}function rateMedia(b,a){if(b===0.5){$(".rating ul li:first-child i").addClass("half");$(".rating ul li:first-child").show()}else{if(b===1){$(".rating ul li:first-child").show()}else{if(b===1.5){$(".rating ul li:nth-child(-n+2)").show();$(".rating ul li:nth-child(2) i").addClass("half")}else{if(b===2){$(".rating ul li:nth-child(-n+2)").show()}else{if(b===2.5){$(".rating ul li:nth-child(-n+3)").show();$(".rating ul li:nth-child(3) i").addClass("half")}else{if(b===3){$(".rating ul li:nth-child(-n+3)").show()}else{if(b===3.5){$(".rating ul li:nth-child(-n+4)").show();$(".rating ul li:nth-child(4) i").addClass("half")}else{if(b===4){$(".rating ul li:nth-child(-n+4)").show()}else{if(b===4.5){$(".rating ul li:nth-child(-n+5)").show();$(".rating ul li:nth-child(5) i").addClass("half")}else{if(b===5){$(".rating ul li").show()}}}}}}}}}}if(a){$(".rating").appendTo(".specialBox").show()}else{$(".rating").appendTo(".meta").show()}}function logMedia(){var a=mediaTags.title;var d=mediaTags.rating;var b=mediaTags.type;if(b==="film"){logFilm(a,d)}else{if(b==="show"){logShow(a,d)}else{if(b==="artist"){logArtist(a,d)}else{if(b==="album"){var c=mediaTags.noartwork;logAlbum(a,d,albumTitle,c)}else{if(b==="book"){logBook(a,d)}else{if(b==="game"){logGame(a,d)}}}}}}}function logFilm(o,k){var g=o.replace(/ /g,"+");var f="http://api.themoviedb.org/3/search/movie?query="+g+"&api_key=99891c192eab41d5d39aa7d4346312e2";$.ajax({url:f,type:"get",dataType:"jsonp",success:function(u){var v=u.results[0].id;i(v)}});var n=3;var l;var q;var t;var s;var r="";var d=0;var b="";var e;var h;var j;var c;var p;var m;function i(x){var w="http://api.themoviedb.org/3/configuration?api_key=99891c192eab41d5d39aa7d4346312e2";var v="http://api.themoviedb.org/3/movie/"+x+"?api_key=99891c192eab41d5d39aa7d4346312e2";var u="http://api.themoviedb.org/3/movie/"+x+"/credits?api_key=99891c192eab41d5d39aa7d4346312e2";$.ajax({url:w,type:"get",dataType:"jsonp",success:function(y){q=y.images.base_url;n--;a()}});$.ajax({url:v,type:"get",dataType:"jsonp",success:function(y){l=q+"w300"+y.poster_path;t=y.title;s=y.overview;h=y.release_date.split("-");j=h[0];c=y.genres.length;p=0;m=y.imdb_id;$.each(y.genres,function(z){p++;if(p===c){r+=y.genres[z].name}else{r+=y.genres[z].name+", "}});n--;a()}});$.ajax({url:u,type:"get",dataType:"jsonp",success:function(y){$.each(y.cast,function(z){if(d>=5){return false}b+="<li>"+y.cast[z].name+"</li>";d++});e="<li>"+y.crew[0].name+"</li>";n--;a()}})}function a(){if(n===0){$(".aside .specialBox").addClass("film").show();$(".aside .specialBox").append('<div class="cover"><div class="left"><img src="'+l+'" /></div><div class="right"><h4>'+t+'</h4><h5 class="year">'+j+'</h5><h5 class="genre">'+r+"</h5></div></div>");$(".aside .specialBox").append("<p>"+s+'</p><div class="director specialList"><h4>Director:</h4><ul>'+e+'</ul></div><div class="cast specialList"><h4>Starring:</h4><ul>'+b+'</ul></div><a href="http://www.imdb.com/title/'+m+'" target="_blank" class="more_link">View on IMDb <i class="p-icon">]</i></a>');if(k>=0){rateMedia(k,true)}}}}function logShow(e,a){var d;var b="http://api.themoviedb.org/3/configuration?api_key=99891c192eab41d5d39aa7d4346312e2";$.ajax({url:b,type:"get",dataType:"jsonp",success:function(g){d=g.images.base_url;apiCount--;f()}});function f(){var h=e.replace(/ /g,"+");var g="http://api.themoviedb.org/3/search/tv?query="+h+"&api_key=99891c192eab41d5d39aa7d4346312e2";$.ajax({url:g,type:"get",dataType:"jsonp",success:function(i){var j=i.results[0].id;c(j)}})}function c(h){var g="http://api.themoviedb.org/3/tv/"+h+"?api_key=99891c192eab41d5d39aa7d4346312e2";$.ajax({url:g,type:"get",dataType:"jsonp",success:function(l){var o=l.name;var m=d+"w300"+l.backdrop_path;var k=l.first_air_date;var j=k.substring(0,4);var i=l.genres[0].name;var n=l.overview;n=n.replace(/\s{2,}/g,"</p><p>");$(".aside .specialBox").addClass("film").show();$(".aside .specialBox").append('<img src="'+m+'" />');$(".aside .specialBox").append("<h4>"+o+"</h4><h5>"+j+" | "+i+"</h5><p>"+n+"</p>");if(a>=0){rateMedia(a,true)}}})}}function logBook(b,c){var d=b.replace(/ /g,"+");var a="https://www.googleapis.com/books/v1/volumes?q="+d+"&key="+booksKey;$.ajax({url:a,type:"get",dataType:"jsonp",success:function(h){h=h.items[0];var e=true;var i=h.volumeInfo.imageLinks.thumbnail;var f=h.volumeInfo.authors[0];var k=h.volumeInfo.title;var j=h.searchInfo.textSnippet;var g=h.volumeInfo.infoLink;$(".aside .specialBox").addClass("book").show();if(e){$(".aside .specialBox").append('<div class="cover"><div class="left"><img src="'+i+'" /></div><div class="right"><h4>'+k+"</h4><h5>"+f+"</h5></div></div>")}else{$(".aside .specialBox").append('<div class="cover"><div class="right"><h4>'+k+"</h4><h5>"+f+"</h5></div></div>")}$(".aside .specialBox").append("<p>"+j+'</p><a href="'+g+'" target="_blank" class="more_link">View on Google Books <i class="p-icon">]</i></a>');if(c>=0){rateMedia(c,true)}}})}function logArtist(d,a){var c=d.replace(/ /g,"+");var b="http://ws.audioscrobbler.com/2.0/?method=artist.getinfo&format=json&artist="+c+"&api_key=0f94f59c4f96689dccc25dca9d870229";$.ajax({url:b,type:"get",dataType:"jsonp",success:function(i){var g=i.artist.image[4]["#text"];var e=i.artist.name;var l=i.artist.bio.summary;l=l.replace(/\s{2,}/g,"</p><p>");var f=i.artist.url;var m=i.artist.tags;var h=i.artist.similar;var k='<li><a href="'+m.tag[0].url+'" target="_blank">'+m.tag[0].name+'</a></li><li><a href="'+m.tag[1].url+'" target="_blank">'+m.tag[1].name+'</a></li><li><a href="'+m.tag[2].url+'" target="_blank">'+m.tag[2].name+'</a></li><li><a href="'+m.tag[3].url+'" target="_blank">'+m.tag[3].name+'</a></li><li><a href="'+m.tag[4].url+'" target="_blank">'+m.tag[4].name+"</a></li>";var j='<li><a href="'+h.artist[0].url+'" target="_blank">'+h.artist[0].name+'</a></li><li><a href="'+h.artist[1].url+'" target="_blank">'+h.artist[1].name+'</a></li><li><a href="'+h.artist[2].url+'" target="_blank">'+h.artist[2].name+'</a></li><li><a href="'+h.artist[3].url+'" target="_blank">'+h.artist[3].name+'</a></li><li><a href="'+h.artist[4].url+'" target="_blank">'+h.artist[4].name+"</a></li>";$(".aside .specialBox").show();$(".aside .specialBox").append('<img src="'+g+'" />');$(".aside .specialBox").append("<h4>"+e+"</h4><p>"+l+'</p><a href="'+f+'" target="_blank" class="more_link">Read More <i class="p-icon">]</i></a><div class="artistTags specialList"><h4>Tags:</h4><ul>'+k+'</ul></div><div class="artistSimilar specialList"><h4>Similar Artists:</h4><ul>'+j+"</ul></div>");if(a>=0){rateMedia(a,true)}}})}function logAlbum(e,d,f,b){var a=e.replace(/ /g,"+");var g=f.replace(/ /g,"+");var c="http://ws.audioscrobbler.com/2.0/?method=album.getinfo&format=json&artist="+a+"&album="+g+"&api_key=c17e99c4cc21ca4bfc346c75b04a50b5";$.ajax({url:c,type:"get",dataType:"jsonp",success:function(k){var l=k.album.image[4]["#text"];var h=k.album.artist;var m=k.album.name;var j;if(k.album.hasOwnProperty("wiki")){j=k.album.wiki.summary;j=j.replace(/\s{2,}/g,"</p><p>")}else{j=""}var i=k.album.url;$(".aside .specialBox").addClass("album").show();if(!b){$(".aside .specialBox").append('<a href="'+i+'" target="_blank"><img src="'+l+'" /></a>')}if(j===""){$(".aside .specialBox").append('<h4><a href="'+i+'" target="_blank">'+m+"</a></h4><h5>"+h+"</h5><p>"+j+"</p>")}else{$(".aside .specialBox").append("<h4>"+m+"</h4><h5>"+h+"</h5><p>"+j+'</p><a href="'+i+'" target="_blank" class="more_link">Read More <i class="p-icon">]</i></a>')}if(d>=0){rateMedia(d,true)}}})}function logGame(e,a){var d=e.replace(/ /g,"+");var b="http://api.giantbomb.com/search/?api_key="+gamesKey+"&query="+d+"&format=jsonp&json_callback=callback";$.ajax({url:b,type:"get",dataType:"jsonp",jsonpCallback:"callback",success:function(f){var g=f.results[0].id;c(g)}});function c(g){var f="http://api.giantbomb.com/game/"+g+"/?api_key=43178ca57283d22ec7569d7f22ad2a83e5758a96&format=jsonp&json_callback=callback";$.ajax({url:f,type:"get",dataType:"jsonp",jsonpCallback:"callback",success:function(n){n=n.results;var l=n.image.super_url;var p=n.deck;var j=n.name;var i=n.publishers[0].name;var o=n.developers[0].name;var k="";var m="";var h=n.site_detail_url;$.each(n.genres,function(q){k+="<span>"+n.genres[q].name+"</span>"});$.each(n.platforms,function(q){m+="<li>"+n.platforms[q].name+"</li>"});$(".aside .specialBox").addClass("film game").show();$(".aside .specialBox").append('<img src="'+l+'" />');$(".aside .specialBox").append("<h4>"+j+"</h4><h5>"+k+"</h5><p>"+p+"</p><p><span>Publisher:</span> "+i+"</p><p><span>Developer:</span> "+o+'</p><div class="platforms specialList"><h4>Platforms:</h4><ul>'+m+'</ul></div><a href="'+h+'" target="_blank" class="more_link">View on Giant Bomb <i class="p-icon">]</i></a>');if(a>=0){rateMedia(a,true)}}})}};